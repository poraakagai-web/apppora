<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relat√≥rio Integrado</title>
    <link rel="stylesheet" href="styles_v5.7.0.css">
</head>
<body>
    <h1>Relat√≥rio Integrado</h1>
    
    <div class="header-controls">
        <button id="toggleDarkMode">Ativar Modo Escuro</button>
        <button id="openHelpModal" class="secondary-button">
            <span class="icon">‚ùì</span>
            Ajuda
            <small style="opacity: 0.7; font-size: 11px;">(F1)</small>
        </button>
        <button id="openDatabaseModal" class="primary-button">
            <span class="icon">üìä</span>
            Configurar Bancos de Dados
            <small style="opacity: 0.7; font-size: 11px;">(Ctrl+D)</small>
        </button>
    </div>
    
    <!-- Navega√ß√£o por Abas -->
    <div class="tab-navigation">
        <button class="tab-button active" data-tab="relatorio-principal">
            <span class="icon">üìä</span>
            Relat√≥rio Principal
        </button>
        <button class="tab-button" data-tab="controle-prazos">
            <span class="icon">‚è∞</span>
            Controle de Prazos
        </button>
        <button class="tab-button" data-tab="conferencia-fisica">
            <span class="icon">üì¶</span>
            Confer√™ncia F√≠sica
        </button>
        <button class="tab-button" data-tab="acompanhamento-distribuicao">
            <span class="icon">üöö</span>
            Acompanhamento de Distribui√ß√£o
        </button>
        <button class="tab-button" data-tab="conferencia-devolucoes">
            <span class="icon">üìã</span>
            Confer√™ncia de Devolu√ß√µes
        </button>
        <button class="tab-button" data-tab="gerenciamento-objetos">
            <span class="icon">üîÑ</span>
            Gerenciamento de Objetos
        </button>
    </div>
    
    <!-- Modal para inser√ß√£o de bancos de dados -->
    <div id="databaseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Configura√ß√£o dos Bancos de Dados</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="database-section">
                    <label for="listDatabase">
                        <span class="icon">üìã</span>
                        Banco de Dados de Lista e Funcion√°rios
                    </label>
                    <textarea id="listDatabase" rows="8" placeholder="Cole aqui o banco de dados de Lista e Funcion√°rios (separado por tabula√ß√µes)"></textarea>
                    <div class="help-text">Formato esperado: Distrito | Funcion√°rio | ... | Lista</div>
                </div>
                
                <div class="database-section">
                    <label for="objectDatabase">
                        <span class="icon">üè†</span>
                        Banco de Dados de Objetos e Endere√ßos
                    </label>
                    <textarea id="objectDatabase" rows="8" placeholder="Cole aqui o banco de dados de Objetos e Endere√ßos (separado por tabula√ß√µes)"></textarea>
                    <div class="help-text">Formato esperado: Lista | Objeto | ... | Endere√ßo</div>
                </div>
                
                <div class="database-section">
                    <label for="prazoDatabase">
                        <span class="icon">‚è∞</span>
                        Banco de Dados de Prazos
                    </label>
                    <textarea id="prazoDatabase" rows="8" placeholder="Cole aqui o banco de dados de Prazos (separado por tabula√ß√µes)"></textarea>
                    <div class="help-text">Formato esperado: N¬∫ Objeto (coluna 1) | ... | Prazo Final (coluna 12) - Data no formato DD/MM/AAAA ou AAAA-MM-DD</div>
                </div>
                
                <div class="database-section">
                    <label for="distribuicaoDatabase">
                        <span class="icon">üöö</span>
                        Banco de Dados de Distribui√ß√£o
                    </label>
                    <textarea id="distribuicaoDatabase" rows="8" placeholder="Cole aqui o banco de dados de Distribui√ß√£o (separado por tabula√ß√µes)"></textarea>
                    <div class="help-text">Formato esperado: Coluna 2 (N¬∫ objeto) | Coluna 4 (Hor√°rio de baixa) | Coluna 8 (Status)</div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="json-controls">
                    <input type="file" id="importJsonFile" accept=".json" style="display: none;">
                    <button id="exportJson" class="secondary-button">
                        <span class="icon">üì§</span>
                        Exportar JSON
                    </button>
                    <button id="importJson" class="secondary-button">
                        <span class="icon">üì•</span>
                        Importar JSON
                    </button>
                </div>
                <div class="main-controls">
                    <button id="clearDatabases" class="secondary-button">Limpar Dados</button>
                    <button id="saveDatabases" class="primary-button">Salvar e Fechar</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de Ajuda -->
    <div id="helpModal" class="modal">
        <div class="modal-content help-modal-content">
            <div class="modal-header">
                <h2>Guia de Ajuda - Relat√≥rio Integrado</h2>
                <span class="close help-close">&times;</span>
            </div>
            <div class="modal-body help-modal-body">
                <iframe id="helpFrame" src="help_guide_complete.html" frameborder="0"></iframe>
            </div>
            <div class="modal-footer">
                <button id="openHelpNewWindow" class="secondary-button">
                    <span class="icon">üîó</span>
                    Abrir em Nova Janela
                </button>
                <button id="closeHelpModal" class="primary-button">Fechar</button>
            </div>
        </div>
    </div>
    
    <!-- Status dos bancos de dados -->
    <div id="databaseStatus" class="database-status" style="display: none;">
        <div class="status-item">
            <span class="icon">üìã</span>
            <span id="listStatus">Lista: N√£o carregado</span>
        </div>
        <div class="status-item">
            <span class="icon">üè†</span>
            <span id="objectStatus">Objetos: N√£o carregado</span>
        </div>
        <div class="status-item">
            <span class="icon">‚è∞</span>
            <span id="prazoStatus">Prazos: N√£o carregado</span>
        </div>
        <div class="status-item">
            <span class="icon">üöö</span>
            <span id="distribuicaoStatus">Distribui√ß√£o: N√£o carregado</span>
        </div>
    </div>
    
    <!-- Aba: Relat√≥rio Principal -->
    <div id="relatorio-principal" class="tab-content active">
        <div class="controls-section">
            <div class="filter-section">
                <div class="filter-group">
                    <label for="searchFilter">
                        <span class="icon">üîç</span>
                        Buscar:
                    </label>
                    <input type="text" id="searchFilter" placeholder="Buscar por distrito, funcion√°rio ou lista...">
                </div>
                
                <div class="filter-group">
                    <label for="filterGrade">
                        <span class="icon">üî¢</span>
                        Grade:
                    </label>
                    <select id="filterGrade">
                        <option value="">Todas as Grades</option>
                        <option value="3">Grade 3 (inicia com "3")</option>
                        <option value="6">Grade 6 (inicia com "6")</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="filterSide">
                        <span class="icon">‚ÜîÔ∏è</span>
                        Lado:
                    </label>
                    <select id="filterSide">
                        <option value="">Todos os Lados</option>
                        <option value="A">Lado A (termina com "A")</option>
                        <option value="B">Lado B (termina com "B")</option>
                    </select>
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="generateReport" class="primary-button">
                    <span class="icon">üìä</span>
                    Gerar Relat√≥rio
                    <small style="opacity: 0.7; font-size: 11px;">(Ctrl+R)</small>
                </button>
                <button id="findCoincidentPoints" class="secondary-button">
                    <span class="icon">üéØ</span>
                    Pontos Coincidentes
                    <small style="opacity: 0.7; font-size: 11px;">(Ctrl+F)</small>
                </button>
            </div>
            
            <div class="export-buttons">
                <button id="exportExcel" class="secondary-button">
                    <span class="icon">üìà</span>
                    Exportar Excel
                    <small style="opacity: 0.7; font-size: 11px;">(Ctrl+E)</small>
                </button>
                <button id="exportCSV" class="secondary-button">
                    <span class="icon">üìÑ</span>
                    Exportar CSV
                </button>
                <button id="printReport" class="secondary-button">
                    <span class="icon">üñ®Ô∏è</span>
                    Imprimir
                    <small style="opacity: 0.7; font-size: 11px;">(Ctrl+P)</small>
                </button>
            </div>
        </div>
        
        <div id="summarySection" class="summary-grid"></div>
        
        <table id="reportTable">
            <thead>
                <tr>
                    <th data-column="distrito">Distrito <span class="sort-hint">‚ÜïÔ∏è</span></th>
                    <th data-column="funcionario">Funcion√°rio <span class="sort-hint">‚ÜïÔ∏è</span></th>
                    <th data-column="lista">N√∫mero da Lista <span class="sort-hint">‚ÜïÔ∏è</span></th>
                    <th data-column="totalObjetos">Total de Objetos <span class="sort-hint">‚ÜïÔ∏è</span></th>
                    <th data-column="totalPontos">Total de Pontos <span class="sort-hint">‚ÜïÔ∏è</span></th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <div id="coincidentPointsSection" class="coincident-points" style="display: none;">
            <h2>Pontos Coincidentes entre Grade 6 e Grade 3</h2>
            <div id="coincidentSummary" class="summary-grid"></div>
            <table id="coincidentPointsTable">
                <thead>
                    <tr>
                        <th>Endere√ßo</th>
                        <th>Distrito (Grade 6)</th>
                        <th>Grade 6 (Listas)</th>
                        <th>Distrito (Grade 3)</th>
                        <th>Grade 3 (Listas)</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    
    <!-- Aba: Controle de Prazos -->
    <div id="controle-prazos" class="tab-content">
        <div class="controls-section">
            <div class="filter-section">
                <div class="filter-group">
                    <label for="prazoDistritoFilter">
                        <span class="icon">üè¢</span>
                        Distrito:
                    </label>
                    <select id="prazoDistritoFilter">
                        <option value="">Todos os Distritos</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="prazoStatusFilter">
                        <span class="icon">üìä</span>
                        Status:
                    </label>
                    <select id="prazoStatusFilter">
                        <option value="">Todos os Status</option>
                        <option value="Atrasado">Atrasado</option>
                        <option value="Vence Hoje">Vence Hoje</option>
                        <option value="No Prazo">No Prazo</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="prazoObjetoFilter">
                        <span class="icon">üì¶</span>
                        Buscar Objeto:
                    </label>
                    <input type="text" id="prazoObjetoFilter" placeholder="Digite o n√∫mero do objeto">
                </div>
                
                <div class="filter-group">
                    <label for="prazoEnderecoFilter">
                        <span class="icon">üìç</span>
                        Buscar Endere√ßo:
                    </label>
                    <input type="text" id="prazoEnderecoFilter" placeholder="Digite parte do endere√ßo">
                </div>
                
                <div class="filter-group">
                    <label for="prazoDiasFilter">
                        <span class="icon">‚è≥</span>
                        Dias Restantes:
                    </label>
                    <select id="prazoDiasFilter">
                        <option value="">Todos</option>
                        <option value="atrasado">Atrasados (< 0)</option>
                        <option value="hoje">Vence Hoje (0)</option>
                        <option value="1-3">1 a 3 dias</option>
                        <option value="4-7">4 a 7 dias</option>
                        <option value="8-15">8 a 15 dias</option>
                        <option value="15+">Mais de 15 dias</option>
                    </select>
                </div>
                
                <div class="filter-actions">
                    <button id="clearPrazoFilters" class="secondary-button">
                        <span class="icon">üóëÔ∏è</span>
                        Limpar Filtros
                    </button>
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="generatePrazoReport" class="primary-button">
                    <span class="icon">‚è∞</span>
                    Gerar Relat√≥rio de Prazos
                </button>
            </div>
        </div>
        
        <div id="prazoSummarySection" class="summary-grid"></div>
        
        <table id="prazoTable">
            <thead>
                <tr>
                    <th class="sortable" data-column="distrito">
                        Distrito
                        <span class="sort-indicator">‚ÜïÔ∏è</span>
                    </th>
                    <th class="sortable" data-column="objeto">
                        Objeto
                        <span class="sort-indicator">‚ÜïÔ∏è</span>
                    </th>
                    <th class="sortable" data-column="endereco">
                        Endere√ßo
                        <span class="sort-indicator">‚ÜïÔ∏è</span>
                    </th>
                    <th class="sortable" data-column="prazoFinal">
                        Prazo Final
                        <span class="sort-indicator">‚ÜïÔ∏è</span>
                    </th>
                    <th class="sortable" data-column="status">
                        Status
                        <span class="sort-indicator">‚ÜïÔ∏è</span>
                    </th>
                    <th class="sortable" data-column="diasRestantes">
                        Dias Restantes
                        <span class="sort-indicator">‚ÜïÔ∏è</span>
                    </th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    
    <!-- Aba: Confer√™ncia F√≠sica -->
    <div id="conferencia-fisica" class="tab-content">
        <div class="controls-section">
            <div class="filter-section">
                <div class="filter-group">
                    <label for="conferenciaDistritoFilter">
                        <span class="icon">üè¢</span>
                        Distrito:
                    </label>
                    <select id="conferenciaDistritoFilter">
                        <option value="">Selecione um Distrito</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="objetoInput">
                        <span class="icon">üì¶</span>
                        N√∫mero do Objeto:
                    </label>
                    <input type="text" id="objetoInput" placeholder="Digite ou escaneie o n√∫mero do objeto (ex: AB527084135BR)" maxlength="13">
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="addObjeto" class="primary-button">
                    <span class="icon">‚ûï</span>
                    Adicionar Objeto
                </button>
                <button id="clearConferencia" class="secondary-button">
                    <span class="icon">üóëÔ∏è</span>
                    Limpar Lista
                </button>
            </div>
        </div>
        
        <div id="conferenciaSummarySection" class="summary-grid"></div>
        
        <table id="conferenciaTable">
            <thead>
                <tr>
                    <th>Objeto</th>
                    <th>Status</th>
                    <th>Endere√ßo</th>
                    <th>Observa√ß√£o</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    
    <!-- Aba: Acompanhamento de Distribui√ß√£o -->
    <div id="acompanhamento-distribuicao" class="tab-content">
        <div class="controls-section">
            <div class="filter-section">
                <div class="filter-group">
                    <label for="distribuicaoDistritoFilter">
                        <span class="icon">üè¢</span>
                        Distrito:
                    </label>
                    <select id="distribuicaoDistritoFilter">
                        <option value="">Todos os Distritos</option>
                    </select>
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="generateDistribuicaoReport" class="primary-button">
                    <span class="icon">üöö</span>
                    Gerar Relat√≥rio de Acompanhamento
                </button>
            </div>
        </div>
        
        <div id="distribuicaoSummarySection" class="summary-grid"></div>
        
        <!-- Tabela de Itiner√°rio -->
        <div id="itinerarioSection" style="display: none;">
            <h3>Itiner√°rio do Carteiro</h3>
            <table id="itinerarioTable">
                <thead>
                    <tr>
                        <th>Objeto</th>
                        <th>Endere√ßo</th>
                        <th>Hor√°rio da Baixa</th>
                        <th>Status</th>
                        <th>Tempo desde a √∫ltima baixa</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        
        <!-- Relat√≥rio Estat√≠stico -->
        <div id="estatisticasSection" style="display: none;">
            <h3>Estat√≠sticas por Status</h3>
            <div id="estatisticasGrid" class="summary-grid"></div>
            <table id="estatisticasTable">
                <thead>
                    <tr>
                        <th>Status</th>
                        <th>Quantidade</th>
                        <th>Percentual</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    
    <!-- Aba: Confer√™ncia de Devolu√ß√µes -->
    <div id="conferencia-devolucoes" class="tab-content">
        <div class="controls-section">
            <div class="filter-section">
                <div class="filter-group">
                    <label for="devolucaoDistritoFilter">
                        <span class="icon">üè¢</span>
                        Distrito:
                    </label>
                    <select id="devolucaoDistritoFilter">
                        <option value="">Selecione um Distrito</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="devolucaoObjetoInput">
                        <span class="icon">üì¶</span>
                        N√∫mero do Objeto:
                    </label>
                    <input type="text" id="devolucaoObjetoInput" placeholder="Digite ou escaneie o n√∫mero do objeto (ex: AB527084135BR)" maxlength="13">
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="addObjetoDevolucao" class="primary-button">
                    <span class="icon">‚ûï</span>
                    Adicionar Objeto
                </button>
                <button id="clearDevolucao" class="secondary-button">
                    <span class="icon">üóëÔ∏è</span>
                    Limpar Lista
                </button>
                <button id="generateDevolucaoReport" class="secondary-button">
                    <span class="icon">üìã</span>
                    Gerar Lista de Devolu√ß√µes
                </button>
            </div>
        </div>
        
        <div id="devolucaoSummarySection" class="summary-grid"></div>
        
        <!-- Lista de Devolu√ß√µes Esperadas -->
        <div id="devolucaoEsperadaSection" style="display: none;">
            <h3>Objetos para Devolu√ß√£o - <span id="devolucaoDistritoTitle"></span></h3>
            <table id="devolucaoEsperadaTable">
                <thead>
                    <tr>
                        <th>Objeto</th>
                        <th>Status</th>
                        <th>Endere√ßo</th>
                        <th>Situa√ß√£o</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        
        <!-- Confer√™ncia de Devolu√ß√µes -->
        <div id="devolucaoConferenciaSection" style="display: none;">
            <h3>Confer√™ncia de Devolu√ß√µes</h3>
            <table id="devolucaoConferenciaTable">
                <thead>
                    <tr>
                        <th>Objeto</th>
                        <th>Status</th>
                        <th>Endere√ßo</th>
                        <th>Situa√ß√£o da Confer√™ncia</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    
    <!-- Aba: Gerenciamento de Objetos -->
    <div id="gerenciamento-objetos" class="tab-content">
        <div class="controls-section">
            <div class="search-section">
                <div class="search-group">
                    <label for="objetoSearchInput">Buscar Objeto:</label>
                    <div class="input-group">
                        <input type="text" id="objetoSearchInput" placeholder="Digite o n√∫mero do objeto (ex: AB123456789BR)" maxlength="13">
                        <button id="searchObjetoBtn" class="primary-button">
                            <span class="icon">üîç</span>
                            Buscar
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Informa√ß√µes do Objeto Encontrado -->
        <div id="objetoInfoSection" class="info-section" style="display: none;">
            <h3>Informa√ß√µes do Objeto</h3>
            <div class="objeto-info-card">
                <div class="info-row">
                    <strong>Objeto:</strong> <span id="objetoNumero"></span>
                </div>
                <div class="info-row">
                    <strong>Endere√ßo:</strong> <span id="objetoEndereco"></span>
                </div>
                <div class="info-row">
                    <strong>Lista Atual:</strong> <span id="objetoListaAtual"></span>
                </div>
                <div class="info-row">
                    <strong>Distrito Atual:</strong> <span id="objetoDistritoAtual"></span>
                </div>
                <div class="info-row">
                    <strong>Funcion√°rio Atual:</strong> <span id="objetoFuncionarioAtual"></span>
                </div>
            </div>
        </div>
        
        <!-- Se√ß√£o de Movimenta√ß√£o -->
        <div id="movimentacaoSection" class="movimentacao-section" style="display: none;">
            <h3>Mover Objeto para Outro Distrito/Lista</h3>
            <div class="movimentacao-controls">
                <div class="filter-group">
                    <label for="novoDistritoSelect">Novo Distrito:</label>
                    <select id="novoDistritoSelect">
                        <option value="">Selecione um distrito</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="novaListaSelect">Nova Lista:</label>
                    <select id="novaListaSelect">
                        <option value="">Selecione uma lista</option>
                    </select>
                </div>
                <div class="movimentacao-actions">
                    <button id="confirmarMovimentacaoBtn" class="primary-button" disabled>
                        <span class="icon">‚úÖ</span>
                        Confirmar Movimenta√ß√£o
                    </button>
                    <button id="cancelarMovimentacaoBtn" class="secondary-button">
                        <span class="icon">‚ùå</span>
                        Cancelar
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Hist√≥rico de Movimenta√ß√µes -->
        <div id="historicoSection" class="historico-section">
            <h3>Hist√≥rico de Movimenta√ß√µes</h3>
            <div class="historico-controls">
                <button id="exportarHistoricoBtn" class="secondary-button">
                    <span class="icon">üì§</span>
                    Exportar Hist√≥rico
                </button>
                <button id="limparHistoricoBtn" class="secondary-button">
                    <span class="icon">üóëÔ∏è</span>
                    Limpar Hist√≥rico
                </button>
            </div>
            <table id="historicoTable">
                <thead>
                    <tr>
                        <th>Data/Hora</th>
                        <th>Objeto</th>
                        <th>De (Distrito/Lista)</th>
                        <th>Para (Distrito/Lista)</th>
                        <th>Usu√°rio</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    
    <!-- Atalhos de teclado -->
    <div class="keyboard-shortcuts" style="display: none;">
        <h3>Atalhos de Teclado</h3>
        <ul>
            <li><kbd>F1</kbd> - Abrir ajuda</li>
            <li><kbd>Ctrl+D</kbd> - Abrir configura√ß√£o de bancos</li>
            <li><kbd>Ctrl+R</kbd> - Gerar relat√≥rio</li>
            <li><kbd>Ctrl+F</kbd> - Buscar pontos coincidentes</li>
            <li><kbd>Ctrl+E</kbd> - Exportar para Excel</li>
            <li><kbd>Ctrl+P</kbd> - Imprimir</li>
            <li><kbd>Ctrl+‚Üí</kbd> - Pr√≥xima aba</li>
            <li><kbd>Ctrl+‚Üê</kbd> - Aba anterior</li>
            <li><kbd>F11</kbd> - Alternar modo escuro</li>
            <li><kbd>ESC</kbd> - Fechar modal</li>
        </ul>
    </div>

    <!-- Bot√£o para mostrar atalhos -->
    <button id="showShortcuts" class="help-button" onclick="toggleShortcuts()">
        <span class="icon">‚å®Ô∏è</span>
        Atalhos
    </button>

    <footer>
        <p>Copyright ¬© Todos os direitos reservados</p>
        <p>Criado por Luiz C S Paula</p>
        <p>Vers√£o: 5.8.0 - Melhorias: Acompanhamento de Distribui√ß√£o, Confer√™ncia de Devolu√ß√µes, An√°lise de Itiner√°rio</p>
    </footer>

    <script src="script_v5.7.0.js"></script>
    <script>
        function toggleShortcuts() {
            const shortcuts = document.querySelector('.keyboard-shortcuts');
            if (shortcuts.style.display === 'none') {
                shortcuts.style.display = 'block';
                shortcuts.scrollIntoView({ behavior: 'smooth' });
            } else {
                shortcuts.style.display = 'none';
            }
        }
    </script>
</body>
</html>

